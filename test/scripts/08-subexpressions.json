[
  {
    "type": "comment",
    "lastValue": null,
    "comments": [
      {
        "text": "Subexpression Tests\nTests for subexpression functionality $( )",
        "codePos": {
          "startRow": 0,
          "startCol": 0,
          "endRow": 1,
          "endCol": 43
        },
        "inline": false
      }
    ],
    "lineNumber": 0
  },
  {
    "type": "command",
    "lastValue": null,
    "codePos": {
      "startRow": 3,
      "startCol": 0,
      "endRow": 3,
      "endCol": 33
    },
    "trailingBlankLines": 1,
    "name": "log",
    "module": null,
    "args": [
      {
        "type": "string",
        "value": "=== Subexpression Tests ==="
      }
    ]
  },
  {
    "type": "command",
    "lastValue": null,
    "codePos": {
      "startRow": 6,
      "startCol": 0,
      "endRow": 6,
      "endCol": 33
    },
    "comments": [
      {
        "text": "Test 1: Basic single-line subexpression",
        "codePos": {
          "startRow": 5,
          "startCol": 0,
          "endRow": 5,
          "endCol": 40
        },
        "inline": false
      }
    ],
    "name": "log",
    "module": null,
    "args": [
      {
        "type": "string",
        "value": "Test 1: Basic subexpression"
      }
    ]
  },
  {
    "type": "assignment",
    "lastValue": null,
    "codePos": {
      "startRow": 7,
      "startCol": 0,
      "endRow": 7,
      "endCol": 24
    },
    "targetName": "test1",
    "targetPath": [],
    "command": {
      "type": "command",
      "lastValue": null,
      "codePos": {
        "startRow": 7,
        "startCol": 9,
        "endRow": 7,
        "endCol": 24
      },
      "name": "_subexpr",
      "module": null,
      "args": [
        {
          "type": "subexpression",
          "body": [
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 7,
                "startCol": 11,
                "endRow": 7,
                "endCol": 23
              },
              "name": "math.add",
              "module": "math",
              "args": [
                {
                  "type": "number",
                  "value": 5
                },
                {
                  "type": "number",
                  "value": 3
                }
              ]
            }
          ],
          "codePos": {
            "startRow": 7,
            "startCol": 9,
            "endRow": 7,
            "endCol": 24
          }
        }
      ]
    }
  },
  {
    "type": "command",
    "lastValue": null,
    "codePos": {
      "startRow": 8,
      "startCol": 0,
      "endRow": 8,
      "endCol": 54
    },
    "trailingBlankLines": 1,
    "name": "test.assertEqual",
    "module": "test",
    "args": [
      {
        "type": "var",
        "name": "test1",
        "path": []
      },
      {
        "type": "number",
        "value": 8
      },
      {
        "type": "string",
        "value": "Basic subexpression failed"
      }
    ]
  },
  {
    "type": "command",
    "lastValue": null,
    "codePos": {
      "startRow": 11,
      "startCol": 0,
      "endRow": 11,
      "endCol": 51
    },
    "comments": [
      {
        "text": "Test 2: Subexpression with variable reference",
        "codePos": {
          "startRow": 10,
          "startCol": 0,
          "endRow": 10,
          "endCol": 46
        },
        "inline": false
      }
    ],
    "name": "log",
    "module": null,
    "args": [
      {
        "type": "string",
        "value": "Test 2: Subexpression with variable reference"
      }
    ]
  },
  {
    "type": "assignment",
    "lastValue": null,
    "codePos": {
      "startRow": 12,
      "startCol": 0,
      "endRow": 12,
      "endCol": 25
    },
    "targetName": "test2",
    "targetPath": [],
    "command": {
      "type": "command",
      "lastValue": null,
      "codePos": {
        "startRow": 12,
        "startCol": 9,
        "endRow": 12,
        "endCol": 25
      },
      "name": "_subexpr",
      "module": null,
      "args": [
        {
          "type": "subexpression",
          "body": [
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 12,
                "startCol": 11,
                "endRow": 12,
                "endCol": 24
              },
              "name": "math.add",
              "module": "math",
              "args": [
                {
                  "type": "number",
                  "value": 10
                },
                {
                  "type": "number",
                  "value": 5
                }
              ]
            }
          ],
          "codePos": {
            "startRow": 12,
            "startCol": 9,
            "endRow": 12,
            "endCol": 25
          }
        }
      ]
    }
  },
  {
    "type": "assignment",
    "lastValue": null,
    "codePos": {
      "startRow": 13,
      "startCol": 0,
      "endRow": 13,
      "endCol": 34
    },
    "targetName": "test3",
    "targetPath": [],
    "command": {
      "type": "command",
      "lastValue": null,
      "codePos": {
        "startRow": 13,
        "startCol": 9,
        "endRow": 13,
        "endCol": 34
      },
      "name": "_subexpr",
      "module": null,
      "args": [
        {
          "type": "subexpression",
          "body": [
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 13,
                "startCol": 11,
                "endRow": 13,
                "endCol": 33
              },
              "name": "math.multiply",
              "module": "math",
              "args": [
                {
                  "type": "var",
                  "name": "test2",
                  "path": []
                },
                {
                  "type": "number",
                  "value": 2
                }
              ]
            }
          ],
          "codePos": {
            "startRow": 13,
            "startCol": 9,
            "endRow": 13,
            "endCol": 34
          }
        }
      ]
    }
  },
  {
    "type": "command",
    "lastValue": null,
    "codePos": {
      "startRow": 14,
      "startCol": 0,
      "endRow": 14,
      "endCol": 73
    },
    "trailingBlankLines": 1,
    "name": "test.assertEqual",
    "module": "test",
    "args": [
      {
        "type": "var",
        "name": "test3",
        "path": []
      },
      {
        "type": "number",
        "value": 30
      },
      {
        "type": "string",
        "value": "Subexpression with variable reference failed"
      }
    ]
  },
  {
    "type": "command",
    "lastValue": null,
    "codePos": {
      "startRow": 17,
      "startCol": 0,
      "endRow": 17,
      "endCol": 35
    },
    "comments": [
      {
        "text": "Test 3: Nested subexpressions",
        "codePos": {
          "startRow": 16,
          "startCol": 0,
          "endRow": 16,
          "endCol": 30
        },
        "inline": false
      }
    ],
    "name": "log",
    "module": null,
    "args": [
      {
        "type": "string",
        "value": "Test 3: Nested subexpressions"
      }
    ]
  },
  {
    "type": "assignment",
    "lastValue": null,
    "codePos": {
      "startRow": 18,
      "startCol": 0,
      "endRow": 145,
      "endCol": 1
    },
    "trailingBlankLines": 1,
    "targetName": "test4",
    "targetPath": [],
    "command": {
      "type": "command",
      "lastValue": null,
      "codePos": {
        "startRow": 18,
        "startCol": 9,
        "endRow": 145,
        "endCol": 1
      },
      "name": "_subexpr",
      "module": null,
      "args": [
        {
          "type": "subexpression",
          "body": [
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 19,
                "startCol": 2,
                "endRow": 19,
                "endCol": 12
              },
              "name": "math.add",
              "module": "math",
              "args": [
                {
                  "type": "subexpression",
                  "body": [
                    {
                      "type": "command",
                      "lastValue": null,
                      "codePos": {
                        "startRow": 19,
                        "startCol": 13,
                        "endRow": 19,
                        "endCol": 30
                      },
                      "name": "math.multiply",
                      "module": "math",
                      "args": [
                        {
                          "type": "number",
                          "value": 2
                        },
                        {
                          "type": "number",
                          "value": 3
                        }
                      ]
                    }
                  ],
                  "codePos": {
                    "startRow": 19,
                    "startCol": 11,
                    "endRow": 19,
                    "endCol": 33
                  }
                },
                {
                  "type": "subexpression",
                  "body": [
                    {
                      "type": "command",
                      "lastValue": null,
                      "codePos": {
                        "startRow": 19,
                        "startCol": 34,
                        "endRow": 19,
                        "endCol": 46
                      },
                      "name": "math.add",
                      "module": "math",
                      "args": [
                        {
                          "type": "number",
                          "value": 1
                        },
                        {
                          "type": "number",
                          "value": 1
                        }
                      ]
                    }
                  ],
                  "codePos": {
                    "startRow": 19,
                    "startCol": 32,
                    "endRow": 19,
                    "endCol": 47
                  }
                }
              ]
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 20,
                "startCol": 2,
                "endRow": 20,
                "endCol": 57
              },
              "name": "test.assertEqual",
              "module": "test",
              "args": [
                {
                  "type": "var",
                  "name": "test4",
                  "path": []
                },
                {
                  "type": "number",
                  "value": 8
                },
                {
                  "type": "string",
                  "value": "Nested subexpression failed"
                }
              ]
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 21,
                "startCol": 2,
                "endRow": 21,
                "endCol": 40
              },
              "name": "log",
              "module": null,
              "args": [
                {
                  "type": "string",
                  "value": "Test 4: Multi-line subexpression"
                }
              ]
            },
            {
              "type": "assignment",
              "lastValue": null,
              "codePos": {
                "startRow": 22,
                "startCol": 2,
                "endRow": 24,
                "endCol": 1
              },
              "targetName": "test5",
              "targetPath": [],
              "command": {
                "type": "command",
                "lastValue": null,
                "codePos": {
                  "startRow": 22,
                  "startCol": 11,
                  "endRow": 24,
                  "endCol": 1
                },
                "name": "_subexpr",
                "module": null,
                "args": [
                  {
                    "type": "subexpression",
                    "body": [
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 23,
                          "startCol": 2,
                          "endRow": 23,
                          "endCol": 16
                        },
                        "name": "math.add",
                        "module": "math",
                        "args": [
                          {
                            "type": "number",
                            "value": 10
                          },
                          {
                            "type": "number",
                            "value": 20
                          }
                        ]
                      }
                    ],
                    "codePos": {
                      "startRow": 22,
                      "startCol": 11,
                      "endRow": 24,
                      "endCol": 1
                    }
                  }
                ]
              }
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 25,
                "startCol": 2,
                "endRow": 25,
                "endCol": 62
              },
              "name": "test.assertEqual",
              "module": "test",
              "args": [
                {
                  "type": "var",
                  "name": "test5",
                  "path": []
                },
                {
                  "type": "number",
                  "value": 30
                },
                {
                  "type": "string",
                  "value": "Multi-line subexpression failed"
                }
              ]
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 26,
                "startCol": 2,
                "endRow": 26,
                "endCol": 66
              },
              "name": "log",
              "module": null,
              "args": [
                {
                  "type": "string",
                  "value": "Test 5: Multi-line subexpression with nested subexpression"
                }
              ]
            },
            {
              "type": "assignment",
              "lastValue": null,
              "codePos": {
                "startRow": 27,
                "startCol": 2,
                "endRow": 29,
                "endCol": 1
              },
              "targetName": "test6",
              "targetPath": [],
              "command": {
                "type": "command",
                "lastValue": null,
                "codePos": {
                  "startRow": 27,
                  "startCol": 11,
                  "endRow": 29,
                  "endCol": 1
                },
                "name": "_subexpr",
                "module": null,
                "args": [
                  {
                    "type": "subexpression",
                    "body": [
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 28,
                          "startCol": 2,
                          "endRow": 28,
                          "endCol": 21
                        },
                        "name": "math.multiply",
                        "module": "math",
                        "args": [
                          {
                            "type": "var",
                            "name": "test2",
                            "path": []
                          },
                          {
                            "type": "subexpression",
                            "body": [
                              {
                                "type": "command",
                                "lastValue": null,
                                "codePos": {
                                  "startRow": 28,
                                  "startCol": 25,
                                  "endRow": 28,
                                  "endCol": 37
                                },
                                "name": "set",
                                "module": null,
                                "args": [
                                  {
                                    "type": "var",
                                    "name": "test2",
                                    "path": []
                                  },
                                  {
                                    "type": "number",
                                    "value": 1
                                  }
                                ]
                              }
                            ],
                            "codePos": {
                              "startRow": 28,
                              "startCol": 23,
                              "endRow": 28,
                              "endCol": 38
                            }
                          }
                        ]
                      }
                    ],
                    "codePos": {
                      "startRow": 27,
                      "startCol": 11,
                      "endRow": 29,
                      "endCol": 1
                    }
                  }
                ]
              }
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 30,
                "startCol": 2,
                "endRow": 30,
                "endCol": 116
              },
              "name": "test.assertEqual",
              "module": "test",
              "args": [
                {
                  "type": "var",
                  "name": "test6",
                  "path": []
                },
                {
                  "type": "number",
                  "value": 15
                },
                {
                  "type": "string",
                  "value": "Multi-line subexpression with nested subexpression failed (math.multiply 15 null = 0)"
                }
              ]
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 31,
                "startCol": 2,
                "endRow": 31,
                "endCol": 64
              },
              "name": "test.assertEqual",
              "module": "test",
              "args": [
                {
                  "type": "var",
                  "name": "test2",
                  "path": []
                },
                {
                  "type": "number",
                  "value": 1
                },
                {
                  "type": "string",
                  "value": "Nested set in subexpression failed"
                }
              ]
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 32,
                "startCol": 2,
                "endRow": 32,
                "endCol": 48
              },
              "name": "log",
              "module": null,
              "args": [
                {
                  "type": "string",
                  "value": "Test 6: Complex multi-line subexpression"
                }
              ]
            },
            {
              "type": "assignment",
              "lastValue": null,
              "codePos": {
                "startRow": 33,
                "startCol": 2,
                "endRow": 36,
                "endCol": 1
              },
              "targetName": "test7",
              "targetPath": [],
              "command": {
                "type": "command",
                "lastValue": null,
                "codePos": {
                  "startRow": 33,
                  "startCol": 11,
                  "endRow": 36,
                  "endCol": 1
                },
                "name": "_subexpr",
                "module": null,
                "args": [
                  {
                    "type": "subexpression",
                    "body": [
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 34,
                          "startCol": 2,
                          "endRow": 34,
                          "endCol": 14
                        },
                        "name": "math.add",
                        "module": "math",
                        "args": [
                          {
                            "type": "number",
                            "value": 5
                          },
                          {
                            "type": "number",
                            "value": 5
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 35,
                          "startCol": 2,
                          "endRow": 35,
                          "endCol": 19
                        },
                        "name": "math.multiply",
                        "module": "math",
                        "args": [
                          {
                            "type": "lastValue"
                          },
                          {
                            "type": "number",
                            "value": 3
                          }
                        ]
                      }
                    ],
                    "codePos": {
                      "startRow": 33,
                      "startCol": 11,
                      "endRow": 36,
                      "endCol": 1
                    }
                  }
                ]
              }
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 37,
                "startCol": 2,
                "endRow": 37,
                "endCol": 70
              },
              "name": "test.assertEqual",
              "module": "test",
              "args": [
                {
                  "type": "var",
                  "name": "test7",
                  "path": []
                },
                {
                  "type": "number",
                  "value": 30
                },
                {
                  "type": "string",
                  "value": "Complex multi-line subexpression failed"
                }
              ]
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 38,
                "startCol": 2,
                "endRow": 38,
                "endCol": 46
              },
              "name": "log",
              "module": null,
              "args": [
                {
                  "type": "string",
                  "value": "Test 7: Subexpression in function call"
                }
              ]
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 39,
                "startCol": 2,
                "endRow": 39,
                "endCol": 6
              },
              "name": "clear",
              "module": null,
              "args": []
            },
            {
              "type": "do",
              "lastValue": null,
              "codePos": {
                "startRow": 40,
                "startCol": 2,
                "endRow": 43,
                "endCol": 6
              },
              "body": [
                {
                  "type": "command",
                  "lastValue": null,
                  "codePos": {
                    "startRow": 41,
                    "startCol": 4,
                    "endRow": 41,
                    "endCol": 14
                  },
                  "name": "math.add",
                  "module": "math",
                  "args": [
                    {
                      "type": "subexpression",
                      "body": [
                        {
                          "type": "command",
                          "lastValue": null,
                          "codePos": {
                            "startRow": 41,
                            "startCol": 15,
                            "endRow": 41,
                            "endCol": 32
                          },
                          "name": "math.multiply",
                          "module": "math",
                          "args": [
                            {
                              "type": "number",
                              "value": 2
                            },
                            {
                              "type": "number",
                              "value": 5
                            }
                          ]
                        }
                      ],
                      "codePos": {
                        "startRow": 41,
                        "startCol": 13,
                        "endRow": 41,
                        "endCol": 35
                      }
                    },
                    {
                      "type": "subexpression",
                      "body": [
                        {
                          "type": "command",
                          "lastValue": null,
                          "codePos": {
                            "startRow": 41,
                            "startCol": 36,
                            "endRow": 41,
                            "endCol": 48
                          },
                          "name": "math.add",
                          "module": "math",
                          "args": [
                            {
                              "type": "number",
                              "value": 3
                            },
                            {
                              "type": "number",
                              "value": 2
                            }
                          ]
                        }
                      ],
                      "codePos": {
                        "startRow": 41,
                        "startCol": 34,
                        "endRow": 41,
                        "endCol": 49
                      }
                    }
                  ]
                },
                {
                  "type": "command",
                  "lastValue": null,
                  "codePos": {
                    "startRow": 42,
                    "startCol": 4,
                    "endRow": 42,
                    "endCol": 65
                  },
                  "name": "test.assertEqual",
                  "module": "test",
                  "args": [
                    {
                      "type": "lastValue"
                    },
                    {
                      "type": "number",
                      "value": 15
                    },
                    {
                      "type": "string",
                      "value": "Subexpression in function call failed"
                    }
                  ]
                }
              ]
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 44,
                "startCol": 2,
                "endRow": 44,
                "endCol": 44
              },
              "name": "log",
              "module": null,
              "args": [
                {
                  "type": "string",
                  "value": "Test 8: Subexpression in conditional"
                }
              ]
            },
            {
              "type": "ifBlock",
              "lastValue": null,
              "codePos": {
                "startRow": 45,
                "startCol": 2,
                "endRow": 49,
                "endCol": 6
              },
              "condition": {
                "type": "binary",
                "operator": "==",
                "left": {
                  "type": "subexpression",
                  "body": [
                    {
                      "type": "command",
                      "name": "math.add",
                      "args": [
                        {
                          "type": "number",
                          "value": 5
                        },
                        {
                          "type": "number",
                          "value": 5
                        }
                      ],
                      "codePos": {
                        "startRow": 45,
                        "startCol": 7,
                        "endRow": 45,
                        "endCol": 19
                      }
                    }
                  ],
                  "codePos": {
                    "startRow": 45,
                    "startCol": 5,
                    "endRow": 45,
                    "endCol": 22
                  }
                },
                "right": {
                  "type": "number",
                  "value": 10,
                  "codePos": {
                    "startRow": 45,
                    "startCol": 24,
                    "endRow": 45,
                    "endCol": 25
                  }
                },
                "codePos": {
                  "startRow": 45,
                  "startCol": 5,
                  "endRow": 45,
                  "endCol": 22
                }
              },
              "conditionExpr": {
                "type": "binary",
                "operator": "==",
                "left": {
                  "type": "subexpression",
                  "body": [
                    {
                      "type": "command",
                      "name": "math.add",
                      "args": [
                        {
                          "type": "number",
                          "value": 5
                        },
                        {
                          "type": "number",
                          "value": 5
                        }
                      ],
                      "codePos": {
                        "startRow": 45,
                        "startCol": 7,
                        "endRow": 45,
                        "endCol": 19
                      }
                    }
                  ],
                  "codePos": {
                    "startRow": 45,
                    "startCol": 5,
                    "endRow": 45,
                    "endCol": 22
                  }
                },
                "right": {
                  "type": "number",
                  "value": 10,
                  "codePos": {
                    "startRow": 45,
                    "startCol": 24,
                    "endRow": 45,
                    "endCol": 25
                  }
                },
                "codePos": {
                  "startRow": 45,
                  "startCol": 5,
                  "endRow": 45,
                  "endCol": 22
                }
              },
              "thenBranch": [
                {
                  "type": "assignment",
                  "lastValue": null,
                  "codePos": {
                    "startRow": 46,
                    "startCol": 4,
                    "endRow": 46,
                    "endCol": 20
                  },
                  "targetName": "test8",
                  "targetPath": [],
                  "literalValue": "passed",
                  "literalValueType": "string"
                }
              ],
              "elseBranch": [
                {
                  "type": "assignment",
                  "lastValue": null,
                  "codePos": {
                    "startRow": 48,
                    "startCol": 4,
                    "endRow": 48,
                    "endCol": 20
                  },
                  "targetName": "test8",
                  "targetPath": [],
                  "literalValue": "failed",
                  "literalValueType": "string"
                }
              ]
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 50,
                "startCol": 2,
                "endRow": 50,
                "endCol": 72
              },
              "name": "test.assertEqual",
              "module": "test",
              "args": [
                {
                  "type": "var",
                  "name": "test8",
                  "path": []
                },
                {
                  "type": "string",
                  "value": "passed"
                },
                {
                  "type": "string",
                  "value": "Subexpression in conditional failed"
                }
              ]
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 51,
                "startCol": 2,
                "endRow": 51,
                "endCol": 52
              },
              "name": "log",
              "module": null,
              "args": [
                {
                  "type": "string",
                  "value": "Test 9: Subexpression with string operations"
                }
              ]
            },
            {
              "type": "assignment",
              "lastValue": null,
              "codePos": {
                "startRow": 52,
                "startCol": 2,
                "endRow": 52,
                "endCol": 47
              },
              "targetName": "test9",
              "targetPath": [],
              "command": {
                "type": "command",
                "lastValue": null,
                "codePos": {
                  "startRow": 52,
                  "startCol": 11,
                  "endRow": 52,
                  "endCol": 47
                },
                "name": "_subexpr",
                "module": null,
                "args": [
                  {
                    "type": "subexpression",
                    "body": [
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 52,
                          "startCol": 13,
                          "endRow": 52,
                          "endCol": 46
                        },
                        "name": "string.concat",
                        "module": "string",
                        "args": [
                          {
                            "type": "string",
                            "value": "hello"
                          },
                          {
                            "type": "string",
                            "value": " "
                          },
                          {
                            "type": "string",
                            "value": "world"
                          }
                        ]
                      }
                    ],
                    "codePos": {
                      "startRow": 52,
                      "startCol": 11,
                      "endRow": 52,
                      "endCol": 47
                    }
                  }
                ]
              }
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 53,
                "startCol": 2,
                "endRow": 53,
                "endCol": 85
              },
              "name": "test.assertEqual",
              "module": "test",
              "args": [
                {
                  "type": "var",
                  "name": "test9",
                  "path": []
                },
                {
                  "type": "string",
                  "value": "hello world"
                },
                {
                  "type": "string",
                  "value": "Subexpression with string operations failed"
                }
              ]
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 54,
                "startCol": 2,
                "endRow": 54,
                "endCol": 52
              },
              "name": "log",
              "module": null,
              "args": [
                {
                  "type": "string",
                  "value": "Test 10: Subexpression with array operations"
                }
              ]
            },
            {
              "type": "assignment",
              "lastValue": null,
              "codePos": {
                "startRow": 55,
                "startCol": 2,
                "endRow": 55,
                "endCol": 33
              },
              "targetName": "test10",
              "targetPath": [],
              "command": {
                "type": "command",
                "lastValue": null,
                "codePos": {
                  "startRow": 55,
                  "startCol": 12,
                  "endRow": 55,
                  "endCol": 33
                },
                "name": "_subexpr",
                "module": null,
                "args": [
                  {
                    "type": "subexpression",
                    "body": [
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 55,
                          "startCol": 14,
                          "endRow": 55,
                          "endCol": 32
                        },
                        "name": "array.create",
                        "module": "array",
                        "args": [
                          {
                            "type": "number",
                            "value": 1
                          },
                          {
                            "type": "number",
                            "value": 2
                          },
                          {
                            "type": "number",
                            "value": 3
                          }
                        ]
                      }
                    ],
                    "codePos": {
                      "startRow": 55,
                      "startCol": 12,
                      "endRow": 55,
                      "endCol": 33
                    }
                  }
                ]
              }
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 56,
                "startCol": 2,
                "endRow": 56,
                "endCol": 6
              },
              "name": "clear",
              "module": null,
              "args": []
            },
            {
              "type": "do",
              "lastValue": null,
              "codePos": {
                "startRow": 57,
                "startCol": 2,
                "endRow": 60,
                "endCol": 6
              },
              "body": [
                {
                  "type": "command",
                  "lastValue": null,
                  "codePos": {
                    "startRow": 58,
                    "startCol": 4,
                    "endRow": 58,
                    "endCol": 24
                  },
                  "name": "array.length",
                  "module": "array",
                  "args": [
                    {
                      "type": "var",
                      "name": "test10",
                      "path": []
                    }
                  ]
                },
                {
                  "type": "command",
                  "lastValue": null,
                  "codePos": {
                    "startRow": 59,
                    "startCol": 4,
                    "endRow": 59,
                    "endCol": 69
                  },
                  "name": "test.assertEqual",
                  "module": "test",
                  "args": [
                    {
                      "type": "lastValue"
                    },
                    {
                      "type": "number",
                      "value": 3
                    },
                    {
                      "type": "string",
                      "value": "Subexpression with array operations failed"
                    }
                  ]
                }
              ]
            },
            {
              "type": "command",
              "lastValue": null,
              "codePos": {
                "startRow": 61,
                "startCol": 2,
                "endRow": 61,
                "endCol": 45
              },
              "name": "log",
              "module": null,
              "args": [
                {
                  "type": "string",
                  "value": "Test 11: Deeply nested subexpressions"
                }
              ]
            },
            {
              "type": "assignment",
              "lastValue": null,
              "codePos": {
                "startRow": 62,
                "startCol": 2,
                "endRow": 144,
                "endCol": 1
              },
              "targetName": "test11",
              "targetPath": [],
              "command": {
                "type": "command",
                "lastValue": null,
                "codePos": {
                  "startRow": 62,
                  "startCol": 12,
                  "endRow": 144,
                  "endCol": 1
                },
                "name": "_subexpr",
                "module": null,
                "args": [
                  {
                    "type": "subexpression",
                    "body": [
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 63,
                          "startCol": 2,
                          "endRow": 63,
                          "endCol": 12
                        },
                        "name": "math.add",
                        "module": "math",
                        "args": [
                          {
                            "type": "subexpression",
                            "body": [
                              {
                                "type": "command",
                                "lastValue": null,
                                "codePos": {
                                  "startRow": 63,
                                  "startCol": 13,
                                  "endRow": 63,
                                  "endCol": 44
                                },
                                "name": "math.multiply",
                                "module": "math",
                                "args": [
                                  {
                                    "type": "subexpression",
                                    "body": [
                                      {
                                        "type": "command",
                                        "lastValue": null,
                                        "codePos": {
                                          "startRow": 63,
                                          "startCol": 29,
                                          "endRow": 63,
                                          "endCol": 41
                                        },
                                        "name": "math.add",
                                        "module": "math",
                                        "args": [
                                          {
                                            "type": "number",
                                            "value": 1
                                          },
                                          {
                                            "type": "number",
                                            "value": 1
                                          }
                                        ]
                                      }
                                    ],
                                    "codePos": {
                                      "startRow": 63,
                                      "startCol": 27,
                                      "endRow": 63,
                                      "endCol": 43
                                    }
                                  },
                                  {
                                    "type": "number",
                                    "value": 2
                                  }
                                ]
                              }
                            ],
                            "codePos": {
                              "startRow": 63,
                              "startCol": 11,
                              "endRow": 63,
                              "endCol": 47
                            }
                          },
                          {
                            "type": "subexpression",
                            "body": [
                              {
                                "type": "command",
                                "lastValue": null,
                                "codePos": {
                                  "startRow": 63,
                                  "startCol": 48,
                                  "endRow": 63,
                                  "endCol": 60
                                },
                                "name": "math.add",
                                "module": "math",
                                "args": [
                                  {
                                    "type": "number",
                                    "value": 1
                                  },
                                  {
                                    "type": "number",
                                    "value": 1
                                  }
                                ]
                              }
                            ],
                            "codePos": {
                              "startRow": 63,
                              "startCol": 46,
                              "endRow": 63,
                              "endCol": 61
                            }
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 64,
                          "startCol": 2,
                          "endRow": 64,
                          "endCol": 65
                        },
                        "name": "test.assertEqual",
                        "module": "test",
                        "args": [
                          {
                            "type": "var",
                            "name": "test11",
                            "path": []
                          },
                          {
                            "type": "number",
                            "value": 6
                          },
                          {
                            "type": "string",
                            "value": "Deeply nested subexpression failed"
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 65,
                          "startCol": 2,
                          "endRow": 65,
                          "endCol": 50
                        },
                        "name": "log",
                        "module": null,
                        "args": [
                          {
                            "type": "string",
                            "value": "Test 12: Subexpression in return statement"
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 66,
                          "startCol": 2,
                          "endRow": 66,
                          "endCol": 24
                        },
                        "name": "def",
                        "module": null,
                        "args": [
                          {
                            "type": "literal",
                            "value": "test_subexpr_return"
                          }
                        ]
                      },
                      {
                        "type": "return",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 67,
                          "startCol": 2,
                          "endRow": 67,
                          "endCol": 26
                        },
                        "value": {
                          "type": "subexpression",
                          "body": [
                            {
                              "type": "command",
                              "lastValue": null,
                              "codePos": {
                                "startRow": 67,
                                "startCol": 11,
                                "endRow": 67,
                                "endCol": 25
                              },
                              "name": "math.add",
                              "module": "math",
                              "args": [
                                {
                                  "type": "number",
                                  "value": 10
                                },
                                {
                                  "type": "number",
                                  "value": 20
                                }
                              ]
                            }
                          ],
                          "codePos": {
                            "startRow": 67,
                            "startCol": 9,
                            "endRow": 67,
                            "endCol": 26
                          }
                        }
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 68,
                          "startCol": 2,
                          "endRow": 68,
                          "endCol": 7
                        },
                        "name": "enddef",
                        "module": null,
                        "args": []
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 69,
                          "startCol": 2,
                          "endRow": 69,
                          "endCol": 6
                        },
                        "name": "clear",
                        "module": null,
                        "args": []
                      },
                      {
                        "type": "do",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 70,
                          "startCol": 2,
                          "endRow": 73,
                          "endCol": 6
                        },
                        "body": [
                          {
                            "type": "command",
                            "lastValue": null,
                            "codePos": {
                              "startRow": 71,
                              "startCol": 4,
                              "endRow": 71,
                              "endCol": 22
                            },
                            "name": "test_subexpr_return",
                            "module": null,
                            "args": []
                          },
                          {
                            "type": "command",
                            "lastValue": null,
                            "codePos": {
                              "startRow": 72,
                              "startCol": 4,
                              "endRow": 72,
                              "endCol": 68
                            },
                            "name": "test.assertEqual",
                            "module": "test",
                            "args": [
                              {
                                "type": "lastValue"
                              },
                              {
                                "type": "number",
                                "value": 30
                              },
                              {
                                "type": "string",
                                "value": "Subexpression in return statement failed"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 74,
                          "startCol": 2,
                          "endRow": 74,
                          "endCol": 66
                        },
                        "name": "log",
                        "module": null,
                        "args": [
                          {
                            "type": "string",
                            "value": "Test 13: Multi-line subexpression with multiple statements"
                          }
                        ]
                      },
                      {
                        "type": "assignment",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 75,
                          "startCol": 2,
                          "endRow": 79,
                          "endCol": 1
                        },
                        "targetName": "test12",
                        "targetPath": [],
                        "command": {
                          "type": "command",
                          "lastValue": null,
                          "codePos": {
                            "startRow": 75,
                            "startCol": 12,
                            "endRow": 79,
                            "endCol": 1
                          },
                          "name": "_subexpr",
                          "module": null,
                          "args": [
                            {
                              "type": "subexpression",
                              "body": [
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 76,
                                    "startCol": 2,
                                    "endRow": 76,
                                    "endCol": 14
                                  },
                                  "name": "math.add",
                                  "module": "math",
                                  "args": [
                                    {
                                      "type": "number",
                                      "value": 1
                                    },
                                    {
                                      "type": "number",
                                      "value": 2
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 77,
                                    "startCol": 2,
                                    "endRow": 77,
                                    "endCol": 19
                                  },
                                  "name": "math.multiply",
                                  "module": "math",
                                  "args": [
                                    {
                                      "type": "lastValue"
                                    },
                                    {
                                      "type": "number",
                                      "value": 2
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 78,
                                    "startCol": 2,
                                    "endRow": 78,
                                    "endCol": 14
                                  },
                                  "name": "math.add",
                                  "module": "math",
                                  "args": [
                                    {
                                      "type": "lastValue"
                                    },
                                    {
                                      "type": "number",
                                      "value": 1
                                    }
                                  ]
                                }
                              ],
                              "codePos": {
                                "startRow": 75,
                                "startCol": 12,
                                "endRow": 79,
                                "endCol": 1
                              }
                            }
                          ]
                        }
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 80,
                          "startCol": 2,
                          "endRow": 80,
                          "endCol": 87
                        },
                        "name": "test.assertEqual",
                        "module": "test",
                        "args": [
                          {
                            "type": "var",
                            "name": "test12",
                            "path": []
                          },
                          {
                            "type": "number",
                            "value": 7
                          },
                          {
                            "type": "string",
                            "value": "Multi-line subexpression with multiple statements failed"
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 81,
                          "startCol": 2,
                          "endRow": 81,
                          "endCol": 55
                        },
                        "name": "log",
                        "module": null,
                        "args": [
                          {
                            "type": "string",
                            "value": "Test 14: Subexpression with variable assignment"
                          }
                        ]
                      },
                      {
                        "type": "assignment",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 82,
                          "startCol": 2,
                          "endRow": 82,
                          "endCol": 14
                        },
                        "targetName": "testVar",
                        "targetPath": [],
                        "literalValue": 10,
                        "literalValueType": "number"
                      },
                      {
                        "type": "assignment",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 83,
                          "startCol": 2,
                          "endRow": 86,
                          "endCol": 1
                        },
                        "targetName": "test13",
                        "targetPath": [],
                        "command": {
                          "type": "command",
                          "lastValue": null,
                          "codePos": {
                            "startRow": 83,
                            "startCol": 12,
                            "endRow": 86,
                            "endCol": 1
                          },
                          "name": "_subexpr",
                          "module": null,
                          "args": [
                            {
                              "type": "subexpression",
                              "body": [
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 84,
                                    "startCol": 2,
                                    "endRow": 84,
                                    "endCol": 17
                                  },
                                  "name": "set",
                                  "module": null,
                                  "args": [
                                    {
                                      "type": "var",
                                      "name": "testVar",
                                      "path": []
                                    },
                                    {
                                      "type": "number",
                                      "value": 42
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 85,
                                    "startCol": 2,
                                    "endRow": 85,
                                    "endCol": 21
                                  },
                                  "name": "math.add",
                                  "module": "math",
                                  "args": [
                                    {
                                      "type": "var",
                                      "name": "testVar",
                                      "path": []
                                    },
                                    {
                                      "type": "number",
                                      "value": 8
                                    }
                                  ]
                                }
                              ],
                              "codePos": {
                                "startRow": 83,
                                "startCol": 12,
                                "endRow": 86,
                                "endCol": 1
                              }
                            }
                          ]
                        }
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 87,
                          "startCol": 2,
                          "endRow": 87,
                          "endCol": 77
                        },
                        "name": "test.assertEqual",
                        "module": "test",
                        "args": [
                          {
                            "type": "var",
                            "name": "test13",
                            "path": []
                          },
                          {
                            "type": "number",
                            "value": 50
                          },
                          {
                            "type": "string",
                            "value": "Subexpression with variable assignment failed"
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 88,
                          "startCol": 2,
                          "endRow": 88,
                          "endCol": 93
                        },
                        "name": "test.assertEqual",
                        "module": "test",
                        "args": [
                          {
                            "type": "var",
                            "name": "testVar",
                            "path": []
                          },
                          {
                            "type": "number",
                            "value": 42
                          },
                          {
                            "type": "string",
                            "value": "Variable assignment in subexpression should modify parent do"
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 89,
                          "startCol": 2,
                          "endRow": 89,
                          "endCol": 54
                        },
                        "name": "log",
                        "module": null,
                        "args": [
                          {
                            "type": "string",
                            "value": "Test 15: Def function with $1 in subexpression"
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 90,
                          "startCol": 2,
                          "endRow": 90,
                          "endCol": 21
                        },
                        "name": "def",
                        "module": null,
                        "args": [
                          {
                            "type": "literal",
                            "value": "add_with_subexpr"
                          }
                        ]
                      },
                      {
                        "type": "return",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 91,
                          "startCol": 2,
                          "endRow": 91,
                          "endCol": 20
                        },
                        "value": {
                          "type": "subexpression",
                          "body": [
                            {
                              "type": "command",
                              "lastValue": null,
                              "codePos": {
                                "startRow": 91,
                                "startCol": 11,
                                "endRow": 91,
                                "endCol": 19
                              },
                              "name": "add",
                              "module": null,
                              "args": [
                                {
                                  "type": "var",
                                  "name": "1",
                                  "path": []
                                },
                                {
                                  "type": "number",
                                  "value": 2
                                }
                              ]
                            }
                          ],
                          "codePos": {
                            "startRow": 91,
                            "startCol": 9,
                            "endRow": 91,
                            "endCol": 20
                          }
                        }
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 92,
                          "startCol": 2,
                          "endRow": 92,
                          "endCol": 7
                        },
                        "name": "enddef",
                        "module": null,
                        "args": []
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 93,
                          "startCol": 2,
                          "endRow": 93,
                          "endCol": 6
                        },
                        "name": "clear",
                        "module": null,
                        "args": []
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 94,
                          "startCol": 2,
                          "endRow": 94,
                          "endCol": 20
                        },
                        "name": "add_with_subexpr",
                        "module": null,
                        "args": [
                          {
                            "type": "number",
                            "value": 5
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 95,
                          "startCol": 2,
                          "endRow": 95,
                          "endCol": 69
                        },
                        "name": "test.assertEqual",
                        "module": "test",
                        "args": [
                          {
                            "type": "lastValue"
                          },
                          {
                            "type": "number",
                            "value": 7
                          },
                          {
                            "type": "string",
                            "value": "def function with $1 in subexpression failed"
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 96,
                          "startCol": 2,
                          "endRow": 96,
                          "endCol": 61
                        },
                        "name": "log",
                        "module": null,
                        "args": [
                          {
                            "type": "string",
                            "value": "Test 16: Def function with $1 and $2 in subexpression"
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 97,
                          "startCol": 2,
                          "endRow": 97,
                          "endCol": 19
                        },
                        "name": "def",
                        "module": null,
                        "args": [
                          {
                            "type": "literal",
                            "value": "add_two_params"
                          }
                        ]
                      },
                      {
                        "type": "return",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 98,
                          "startCol": 2,
                          "endRow": 98,
                          "endCol": 21
                        },
                        "value": {
                          "type": "subexpression",
                          "body": [
                            {
                              "type": "command",
                              "lastValue": null,
                              "codePos": {
                                "startRow": 98,
                                "startCol": 11,
                                "endRow": 98,
                                "endCol": 20
                              },
                              "name": "add",
                              "module": null,
                              "args": [
                                {
                                  "type": "var",
                                  "name": "1",
                                  "path": []
                                },
                                {
                                  "type": "var",
                                  "name": "2",
                                  "path": []
                                }
                              ]
                            }
                          ],
                          "codePos": {
                            "startRow": 98,
                            "startCol": 9,
                            "endRow": 98,
                            "endCol": 21
                          }
                        }
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 99,
                          "startCol": 2,
                          "endRow": 99,
                          "endCol": 7
                        },
                        "name": "enddef",
                        "module": null,
                        "args": []
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 100,
                          "startCol": 2,
                          "endRow": 100,
                          "endCol": 6
                        },
                        "name": "clear",
                        "module": null,
                        "args": []
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 101,
                          "startCol": 2,
                          "endRow": 101,
                          "endCol": 22
                        },
                        "name": "add_two_params",
                        "module": null,
                        "args": [
                          {
                            "type": "number",
                            "value": 10
                          },
                          {
                            "type": "number",
                            "value": 20
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 102,
                          "startCol": 2,
                          "endRow": 102,
                          "endCol": 77
                        },
                        "name": "test.assertEqual",
                        "module": "test",
                        "args": [
                          {
                            "type": "lastValue"
                          },
                          {
                            "type": "number",
                            "value": 30
                          },
                          {
                            "type": "string",
                            "value": "def function with $1 and $2 in subexpression failed"
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 103,
                          "startCol": 2,
                          "endRow": 103,
                          "endCol": 72
                        },
                        "name": "log",
                        "module": null,
                        "args": [
                          {
                            "type": "string",
                            "value": "Test 17: Def function with nested subexpressions using $1 and $2"
                          }
                        ]
                      },
                      {
                        "type": "command",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 104,
                          "startCol": 2,
                          "endRow": 104,
                          "endCol": 24
                        },
                        "name": "def",
                        "module": null,
                        "args": [
                          {
                            "type": "literal",
                            "value": "nested_subexpr_test"
                          }
                        ]
                      },
                      {
                        "type": "assignment",
                        "lastValue": null,
                        "codePos": {
                          "startRow": 105,
                          "startCol": 2,
                          "endRow": 143,
                          "endCol": 1
                        },
                        "targetName": "result",
                        "targetPath": [],
                        "command": {
                          "type": "command",
                          "lastValue": null,
                          "codePos": {
                            "startRow": 105,
                            "startCol": 12,
                            "endRow": 143,
                            "endCol": 1
                          },
                          "name": "_subexpr",
                          "module": null,
                          "args": [
                            {
                              "type": "subexpression",
                              "body": [
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 106,
                                    "startCol": 2,
                                    "endRow": 106,
                                    "endCol": 17
                                  },
                                  "name": "math.multiply",
                                  "module": "math",
                                  "args": [
                                    {
                                      "type": "subexpression",
                                      "body": [
                                        {
                                          "type": "command",
                                          "lastValue": null,
                                          "codePos": {
                                            "startRow": 106,
                                            "startCol": 18,
                                            "endRow": 106,
                                            "endCol": 26
                                          },
                                          "name": "add",
                                          "module": null,
                                          "args": [
                                            {
                                              "type": "var",
                                              "name": "1",
                                              "path": []
                                            },
                                            {
                                              "type": "number",
                                              "value": 5
                                            }
                                          ]
                                        }
                                      ],
                                      "codePos": {
                                        "startRow": 106,
                                        "startCol": 16,
                                        "endRow": 106,
                                        "endCol": 29
                                      }
                                    },
                                    {
                                      "type": "subexpression",
                                      "body": [
                                        {
                                          "type": "command",
                                          "lastValue": null,
                                          "codePos": {
                                            "startRow": 106,
                                            "startCol": 30,
                                            "endRow": 106,
                                            "endCol": 39
                                          },
                                          "name": "add",
                                          "module": null,
                                          "args": [
                                            {
                                              "type": "var",
                                              "name": "2",
                                              "path": []
                                            },
                                            {
                                              "type": "number",
                                              "value": 10
                                            }
                                          ]
                                        }
                                      ],
                                      "codePos": {
                                        "startRow": 106,
                                        "startCol": 28,
                                        "endRow": 106,
                                        "endCol": 40
                                      }
                                    }
                                  ]
                                },
                                {
                                  "type": "return",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 107,
                                    "startCol": 2,
                                    "endRow": 107,
                                    "endCol": 16
                                  },
                                  "value": {
                                    "type": "var",
                                    "name": "result",
                                    "path": []
                                  }
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 108,
                                    "startCol": 2,
                                    "endRow": 108,
                                    "endCol": 7
                                  },
                                  "name": "enddef",
                                  "module": null,
                                  "args": []
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 109,
                                    "startCol": 2,
                                    "endRow": 109,
                                    "endCol": 6
                                  },
                                  "name": "clear",
                                  "module": null,
                                  "args": []
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 110,
                                    "startCol": 2,
                                    "endRow": 110,
                                    "endCol": 25
                                  },
                                  "name": "nested_subexpr_test",
                                  "module": null,
                                  "args": [
                                    {
                                      "type": "number",
                                      "value": 2
                                    },
                                    {
                                      "type": "number",
                                      "value": 3
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 111,
                                    "startCol": 2,
                                    "endRow": 111,
                                    "endCol": 116
                                  },
                                  "name": "test.assertEqual",
                                  "module": "test",
                                  "args": [
                                    {
                                      "type": "lastValue"
                                    },
                                    {
                                      "type": "number",
                                      "value": 91
                                    },
                                    {
                                      "type": "string",
                                      "value": "def function with nested subexpressions using $1 and $2 failed (should be (2+5)*(3+10)=91)"
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 112,
                                    "startCol": 2,
                                    "endRow": 112,
                                    "endCol": 65
                                  },
                                  "name": "log",
                                  "module": null,
                                  "args": [
                                    {
                                      "type": "string",
                                      "value": "Test 18: Def function with $1 in multi-line subexpression"
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 113,
                                    "startCol": 2,
                                    "endRow": 113,
                                    "endCol": 23
                                  },
                                  "name": "def",
                                  "module": null,
                                  "args": [
                                    {
                                      "type": "literal",
                                      "value": "multi_line_subexpr"
                                    }
                                  ]
                                },
                                {
                                  "type": "assignment",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 114,
                                    "startCol": 2,
                                    "endRow": 117,
                                    "endCol": 1
                                  },
                                  "targetName": "result",
                                  "targetPath": [],
                                  "command": {
                                    "type": "command",
                                    "lastValue": null,
                                    "codePos": {
                                      "startRow": 114,
                                      "startCol": 12,
                                      "endRow": 117,
                                      "endCol": 1
                                    },
                                    "name": "_subexpr",
                                    "module": null,
                                    "args": [
                                      {
                                        "type": "subexpression",
                                        "body": [
                                          {
                                            "type": "command",
                                            "lastValue": null,
                                            "codePos": {
                                              "startRow": 115,
                                              "startCol": 2,
                                              "endRow": 115,
                                              "endCol": 11
                                            },
                                            "name": "add",
                                            "module": null,
                                            "args": [
                                              {
                                                "type": "var",
                                                "name": "1",
                                                "path": []
                                              },
                                              {
                                                "type": "number",
                                                "value": 10
                                              }
                                            ]
                                          },
                                          {
                                            "type": "command",
                                            "lastValue": null,
                                            "codePos": {
                                              "startRow": 116,
                                              "startCol": 2,
                                              "endRow": 116,
                                              "endCol": 19
                                            },
                                            "name": "math.multiply",
                                            "module": "math",
                                            "args": [
                                              {
                                                "type": "lastValue"
                                              },
                                              {
                                                "type": "number",
                                                "value": 2
                                              }
                                            ]
                                          }
                                        ],
                                        "codePos": {
                                          "startRow": 114,
                                          "startCol": 12,
                                          "endRow": 117,
                                          "endCol": 1
                                        }
                                      }
                                    ]
                                  }
                                },
                                {
                                  "type": "return",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 118,
                                    "startCol": 2,
                                    "endRow": 118,
                                    "endCol": 16
                                  },
                                  "value": {
                                    "type": "var",
                                    "name": "result",
                                    "path": []
                                  }
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 119,
                                    "startCol": 2,
                                    "endRow": 119,
                                    "endCol": 7
                                  },
                                  "name": "enddef",
                                  "module": null,
                                  "args": []
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 120,
                                    "startCol": 2,
                                    "endRow": 120,
                                    "endCol": 6
                                  },
                                  "name": "clear",
                                  "module": null,
                                  "args": []
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 121,
                                    "startCol": 2,
                                    "endRow": 121,
                                    "endCol": 22
                                  },
                                  "name": "multi_line_subexpr",
                                  "module": null,
                                  "args": [
                                    {
                                      "type": "number",
                                      "value": 5
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 122,
                                    "startCol": 2,
                                    "endRow": 122,
                                    "endCol": 105
                                  },
                                  "name": "test.assertEqual",
                                  "module": "test",
                                  "args": [
                                    {
                                      "type": "lastValue"
                                    },
                                    {
                                      "type": "number",
                                      "value": 30
                                    },
                                    {
                                      "type": "string",
                                      "value": "def function with $1 in multi-line subexpression failed (should be (5+10)*2=30)"
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 123,
                                    "startCol": 2,
                                    "endRow": 123,
                                    "endCol": 66
                                  },
                                  "name": "log",
                                  "module": null,
                                  "args": [
                                    {
                                      "type": "string",
                                      "value": "Test 19: Def function summing $1, $2, $3 in subexpressions"
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 124,
                                    "startCol": 2,
                                    "endRow": 124,
                                    "endCol": 19
                                  },
                                  "name": "def",
                                  "module": null,
                                  "args": [
                                    {
                                      "type": "literal",
                                      "value": "sum_all_params"
                                    }
                                  ]
                                },
                                {
                                  "type": "assignment",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 125,
                                    "startCol": 2,
                                    "endRow": 125,
                                    "endCol": 9
                                  },
                                  "targetName": "sum",
                                  "targetPath": [],
                                  "literalValue": 0,
                                  "literalValueType": "number"
                                },
                                {
                                  "type": "assignment",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 126,
                                    "startCol": 2,
                                    "endRow": 126,
                                    "endCol": 23
                                  },
                                  "targetName": "sum",
                                  "targetPath": [],
                                  "command": {
                                    "type": "command",
                                    "lastValue": null,
                                    "codePos": {
                                      "startRow": 126,
                                      "startCol": 9,
                                      "endRow": 126,
                                      "endCol": 23
                                    },
                                    "name": "_subexpr",
                                    "module": null,
                                    "args": [
                                      {
                                        "type": "subexpression",
                                        "body": [
                                          {
                                            "type": "command",
                                            "lastValue": null,
                                            "codePos": {
                                              "startRow": 126,
                                              "startCol": 11,
                                              "endRow": 126,
                                              "endCol": 22
                                            },
                                            "name": "add",
                                            "module": null,
                                            "args": [
                                              {
                                                "type": "var",
                                                "name": "sum",
                                                "path": []
                                              },
                                              {
                                                "type": "var",
                                                "name": "1",
                                                "path": []
                                              }
                                            ]
                                          }
                                        ],
                                        "codePos": {
                                          "startRow": 126,
                                          "startCol": 9,
                                          "endRow": 126,
                                          "endCol": 23
                                        }
                                      }
                                    ]
                                  }
                                },
                                {
                                  "type": "assignment",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 127,
                                    "startCol": 2,
                                    "endRow": 127,
                                    "endCol": 23
                                  },
                                  "targetName": "sum",
                                  "targetPath": [],
                                  "command": {
                                    "type": "command",
                                    "lastValue": null,
                                    "codePos": {
                                      "startRow": 127,
                                      "startCol": 9,
                                      "endRow": 127,
                                      "endCol": 23
                                    },
                                    "name": "_subexpr",
                                    "module": null,
                                    "args": [
                                      {
                                        "type": "subexpression",
                                        "body": [
                                          {
                                            "type": "command",
                                            "lastValue": null,
                                            "codePos": {
                                              "startRow": 127,
                                              "startCol": 11,
                                              "endRow": 127,
                                              "endCol": 22
                                            },
                                            "name": "add",
                                            "module": null,
                                            "args": [
                                              {
                                                "type": "var",
                                                "name": "sum",
                                                "path": []
                                              },
                                              {
                                                "type": "var",
                                                "name": "2",
                                                "path": []
                                              }
                                            ]
                                          }
                                        ],
                                        "codePos": {
                                          "startRow": 127,
                                          "startCol": 9,
                                          "endRow": 127,
                                          "endCol": 23
                                        }
                                      }
                                    ]
                                  }
                                },
                                {
                                  "type": "assignment",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 128,
                                    "startCol": 2,
                                    "endRow": 128,
                                    "endCol": 23
                                  },
                                  "targetName": "sum",
                                  "targetPath": [],
                                  "command": {
                                    "type": "command",
                                    "lastValue": null,
                                    "codePos": {
                                      "startRow": 128,
                                      "startCol": 9,
                                      "endRow": 128,
                                      "endCol": 23
                                    },
                                    "name": "_subexpr",
                                    "module": null,
                                    "args": [
                                      {
                                        "type": "subexpression",
                                        "body": [
                                          {
                                            "type": "command",
                                            "lastValue": null,
                                            "codePos": {
                                              "startRow": 128,
                                              "startCol": 11,
                                              "endRow": 128,
                                              "endCol": 22
                                            },
                                            "name": "add",
                                            "module": null,
                                            "args": [
                                              {
                                                "type": "var",
                                                "name": "sum",
                                                "path": []
                                              },
                                              {
                                                "type": "var",
                                                "name": "3",
                                                "path": []
                                              }
                                            ]
                                          }
                                        ],
                                        "codePos": {
                                          "startRow": 128,
                                          "startCol": 9,
                                          "endRow": 128,
                                          "endCol": 23
                                        }
                                      }
                                    ]
                                  }
                                },
                                {
                                  "type": "return",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 129,
                                    "startCol": 2,
                                    "endRow": 129,
                                    "endCol": 13
                                  },
                                  "value": {
                                    "type": "var",
                                    "name": "sum",
                                    "path": []
                                  }
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 130,
                                    "startCol": 2,
                                    "endRow": 130,
                                    "endCol": 7
                                  },
                                  "name": "enddef",
                                  "module": null,
                                  "args": []
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 131,
                                    "startCol": 2,
                                    "endRow": 131,
                                    "endCol": 6
                                  },
                                  "name": "clear",
                                  "module": null,
                                  "args": []
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 132,
                                    "startCol": 2,
                                    "endRow": 132,
                                    "endCol": 22
                                  },
                                  "name": "sum_all_params",
                                  "module": null,
                                  "args": [
                                    {
                                      "type": "number",
                                      "value": 1
                                    },
                                    {
                                      "type": "number",
                                      "value": 2
                                    },
                                    {
                                      "type": "number",
                                      "value": 3
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 133,
                                    "startCol": 2,
                                    "endRow": 133,
                                    "endCol": 81
                                  },
                                  "name": "test.assertEqual",
                                  "module": "test",
                                  "args": [
                                    {
                                      "type": "lastValue"
                                    },
                                    {
                                      "type": "number",
                                      "value": 6
                                    },
                                    {
                                      "type": "string",
                                      "value": "def function summing $1, $2, $3 in subexpressions failed"
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 134,
                                    "startCol": 2,
                                    "endRow": 134,
                                    "endCol": 49
                                  },
                                  "name": "log",
                                  "module": null,
                                  "args": [
                                    {
                                      "type": "string",
                                      "value": "Test 20: Def function with mixed $1 usage"
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 135,
                                    "startCol": 2,
                                    "endRow": 135,
                                    "endCol": 16
                                  },
                                  "name": "def",
                                  "module": null,
                                  "args": [
                                    {
                                      "type": "literal",
                                      "value": "mixed_usage"
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 136,
                                    "startCol": 2,
                                    "endRow": 136,
                                    "endCol": 12
                                  },
                                  "name": "log",
                                  "module": null,
                                  "args": [
                                    {
                                      "type": "string",
                                      "value": ">"
                                    },
                                    {
                                      "type": "var",
                                      "name": "1",
                                      "path": []
                                    }
                                  ]
                                },
                                {
                                  "type": "return",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 137,
                                    "startCol": 2,
                                    "endRow": 137,
                                    "endCol": 20
                                  },
                                  "value": {
                                    "type": "subexpression",
                                    "body": [
                                      {
                                        "type": "command",
                                        "lastValue": null,
                                        "codePos": {
                                          "startRow": 137,
                                          "startCol": 11,
                                          "endRow": 137,
                                          "endCol": 19
                                        },
                                        "name": "add",
                                        "module": null,
                                        "args": [
                                          {
                                            "type": "var",
                                            "name": "1",
                                            "path": []
                                          },
                                          {
                                            "type": "number",
                                            "value": 2
                                          }
                                        ]
                                      }
                                    ],
                                    "codePos": {
                                      "startRow": 137,
                                      "startCol": 9,
                                      "endRow": 137,
                                      "endCol": 20
                                    }
                                  }
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 138,
                                    "startCol": 2,
                                    "endRow": 138,
                                    "endCol": 7
                                  },
                                  "name": "enddef",
                                  "module": null,
                                  "args": []
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 139,
                                    "startCol": 2,
                                    "endRow": 139,
                                    "endCol": 6
                                  },
                                  "name": "clear",
                                  "module": null,
                                  "args": []
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 140,
                                    "startCol": 2,
                                    "endRow": 140,
                                    "endCol": 15
                                  },
                                  "name": "mixed_usage",
                                  "module": null,
                                  "args": [
                                    {
                                      "type": "number",
                                      "value": 5
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 141,
                                    "startCol": 2,
                                    "endRow": 141,
                                    "endCol": 64
                                  },
                                  "name": "test.assertEqual",
                                  "module": "test",
                                  "args": [
                                    {
                                      "type": "lastValue"
                                    },
                                    {
                                      "type": "number",
                                      "value": 7
                                    },
                                    {
                                      "type": "string",
                                      "value": "def function with mixed $1 usage failed"
                                    }
                                  ]
                                },
                                {
                                  "type": "command",
                                  "lastValue": null,
                                  "codePos": {
                                    "startRow": 142,
                                    "startCol": 2,
                                    "endRow": 142,
                                    "endCol": 44
                                  },
                                  "name": "log",
                                  "module": null,
                                  "args": [
                                    {
                                      "type": "string",
                                      "value": "=== Subexpression Tests Complete ==="
                                    }
                                  ]
                                }
                              ],
                              "codePos": {
                                "startRow": 105,
                                "startCol": 12,
                                "endRow": 143,
                                "endCol": 1
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "codePos": {
                      "startRow": 62,
                      "startCol": 12,
                      "endRow": 144,
                      "endCol": 1
                    }
                  }
                ]
              }
            }
          ],
          "codePos": {
            "startRow": 18,
            "startCol": 9,
            "endRow": 145,
            "endCol": 1
          }
        }
      ]
    }
  }
]