# Repeat Function Tests
# Tests for repeat function with callback

log "=== Repeat Function Tests ==="

# Test 2: repeat function with callback
log "Test 2: repeat function"
clear
repeat 5 with
  if $2 == null
    return 1
  endif
  add $2 1
endwith
test.assertEqual $ 5 "repeat should iterate 5 times and add 1 each time with explicit null check"

clear
repeat 3 with
  if $2 == null
    return 10
  endif
  add $2 5
  return $
endwith
test.assertEqual $ 20 "repeat with explicit return should accumulate correctly (10 + 5 + 5)"

clear
repeat 4 with into $result2
  if $2 == null
    return 2
  endif
  math.multiply $2 2
endwith
test.assertEqual $result2 16 "repeat with into assignment should work (2 * 2 * 2 * 2 = 16)"

clear
repeat 0 with
  return 100
endwith
test.assertNull $ "repeat with 0 iterations should return null"

clear
repeat 5 with
  if $2 == null
    return 0
  endif
  add $2 $1
endwith
test.assertEqual $ 10 "repeat should accumulate index values (0+1+2+3+4 = 10)"

log "=== Repeat Function Tests Complete ==="
